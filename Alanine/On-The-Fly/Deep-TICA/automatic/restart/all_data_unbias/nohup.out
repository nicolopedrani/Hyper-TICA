###--- PARAMETERS ---###
Barrier for OPES:  40
print points every  100  steps
each iteration lasts  5  ns
Iterations:  20
NN will be trained with the last  1  simulation data
NN will be trained with all the cumulative data
min lag:  0.2 	 max lag:  5 	 number of lag times =  5
###--- Start Simulations ---###
Completed: cp script/input.* script/plumed_descriptors.data script/run_gromacs.sh unbias_A/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
training samples:  17500 	 validation samples 7450
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -0.743      -0.736      0.399  0.032  
INFO: Early stopping
97    -0.785      -0.770      0.408  0.047  
ITERATION NUMBER  1
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -0.751      -0.734      0.055  0.041  
INFO: Early stopping
74    -0.767      -0.748      0.062  0.056  
ITERATION NUMBER  2
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -0.624      -0.614      0.043  0.026  
100   -0.693      -0.681      0.051  0.029  
150   -0.753      -0.737      0.055  0.031  
200   -0.800      -0.781      0.055  0.033  
250   -0.859      -0.837      0.057  0.034  
300   -0.926      -0.905      0.057  0.034  
INFO: Early stopping
309   -0.930      -0.909      0.057  0.034  
ITERATION NUMBER  3
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -0.785      -0.782      0.242  0.102  
100   -0.952      -0.947      0.429  0.114  
150   -1.005      -1.000      0.468  0.118  
INFO: Early stopping
159   -1.010      -1.004      0.472  0.118  
ITERATION NUMBER  4
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.021      -1.018      0.357  0.150  
100   -1.131      -1.127      0.359  0.202  
150   -1.174      -1.169      0.352  0.250  
INFO: Early stopping
182   -1.192      -1.187      0.350  0.269  
ITERATION NUMBER  5
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.238      -1.237      0.801  0.100  
100   -1.356      -1.354      0.900  0.146  
150   -1.394      -1.389      0.942  0.174  
INFO: Early stopping
156   -1.398      -1.392      0.944  0.175  
ITERATION NUMBER  6
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.218      -1.216      0.588  0.200  
100   -1.294      -1.290      0.750  0.205  
150   -1.332      -1.329      0.803  0.204  
INFO: Early stopping
182   -1.348      -1.346      0.821  0.203  
ITERATION NUMBER  7
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.348      -1.344      0.890  0.410  
100   -1.433      -1.430      0.924  0.491  
INFO: Early stopping
138   -1.456      -1.455      0.938  0.499  
ITERATION NUMBER  8
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.362      -1.361      0.784  0.317  
100   -1.420      -1.418      0.810  0.345  
INFO: Early stopping
119   -1.430      -1.427      0.814  0.355  
ITERATION NUMBER  9
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.311      -1.309      0.853  0.134  
100   -1.364      -1.363      0.874  0.143  
INFO: Early stopping
137   -1.385      -1.383      0.880  0.150  
ITERATION NUMBER  10
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.303      -1.301      0.799  0.165  
100   -1.368      -1.367      0.803  0.183  
150   -1.417      -1.419      0.805  0.249  
200   -1.460      -1.465      0.805  0.427  
INFO: Early stopping
210   -1.465      -1.469      0.805  0.451  
ITERATION NUMBER  11
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.428      -1.429      0.791  0.319  
INFO: Early stopping
82    -1.445      -1.446      0.806  0.305  
ITERATION NUMBER  12
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.398      -1.397      0.804  0.420  
INFO: Early stopping
94    -1.428      -1.426      0.817  0.412  
ITERATION NUMBER  13
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/bias13/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.423      -1.426      0.835  0.403  
INFO: Early stopping
90    -1.453      -1.458      0.832  0.503  
ITERATION NUMBER  14
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/bias13/bias14/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.396      -1.396      0.734  0.384  
100   -1.433      -1.433      0.748  0.360  
INFO: Early stopping
105   -1.435      -1.435      0.749  0.356  
ITERATION NUMBER  15
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/bias13/bias14/bias15/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.377      -1.376      0.798  0.120  
INFO: Early stopping
67    -1.386      -1.385      0.799  0.123  
ITERATION NUMBER  16
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/bias13/bias14/bias15/bias16/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Epoch Train Loss  Valid Loss  Eigenvalues             
50    -1.366      -1.366      0.704  0.067  
INFO: Early stopping
56    -1.369      -1.369      0.704  0.066  
ITERATION NUMBER  17
Completed: cp script/input.* script/plumed_descriptors.data script/positions.data script/run_gromacs.sh unbias_A/bias1/bias2/bias3/bias4/bias5/bias6/bias7/bias8/bias9/bias10/bias11/bias12/bias13/bias14/bias15/bias16/bias17/
Completed: sed -i '0,/ns/s/ns.*/ns=5/' run_gromacs.sh
Completed: ./run_gromacs.sh
Traceback (most recent call last):
  File "general_simulation.py", line 240, in <module>
    train_data, valid_data = random_split(dataset,[n_train,n_valid])
  File "/home/npedrani@iit.local/anaconda3/envs/mlcvs/lib/python3.7/site-packages/torch/utils/data/dataset.py", line 351, in random_split
    raise ValueError("Sum of input lengths does not equal the length of the input dataset!")
ValueError: Sum of input lengths does not equal the length of the input dataset!
